
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>เปิดบิลใหม่ - ELF Admin</title>
  <style>
    body { background: #2c0b0b; color: white; font-family: sans-serif; margin: 40px; }
    label, input, select, textarea { display: block; margin: 10px 0; width: 100%; max-width: 400px; }
    button { margin-top: 20px; padding: 10px 20px; }
    .success { color: lime; margin-top: 20px; }
    .error { color: red; margin-top: 20px; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="config.js"></script>
</head>
<body>
  <h1>เปิดบิลใหม่</h1>

  <form id="order-form">
    <label>ชื่อลูกค้า<input name="customer" required></label>
    <label>ยอดรวม (บาท)<input name="amount" type="number" required></label>
    <label>สถานะ
      <select name="status">
        <option value="รอตรวจ">รอตรวจ</option>
        <option value="มัดจำแล้ว">มัดจำแล้ว</option>
      </select>
    </label>
    <label>ลิงก์สลิป (URL)<input name="slip_url" type="url"></label>
    <label>หมายเหตุ<textarea name="note"></textarea></label>
    <button type="submit">บันทึกบิล</button>
  </form>

  <div class="success" id="success-msg" style="display:none;">✅ บันทึกสำเร็จ!</div>
  <div class="error" id="error-msg" style="display:none;"></div>

  <script>
    const form = document.getElementById('order-form');
    const successMsg = document.getElementById('success-msg');
    const errorMsg = document.getElementById('error-msg');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(form).entries());
      const { error } = await supabase.from('orders').insert([{ ...data }]);
      if (error) {
        successMsg.style.display = 'none';
        errorMsg.textContent = '❌ เกิดข้อผิดพลาด: ' + error.message;
        errorMsg.style.display = 'block';
      } else {
        errorMsg.style.display = 'none';
        successMsg.style.display = 'block';
        form.reset();
      }
    });
  </script>
</body>
</html>
