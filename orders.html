<!-- orders.html ‡∏£‡∏∞‡∏ö‡∏ö ELF ‡∏â‡∏ö‡∏±‡∏ö‡∏à‡∏£‡∏¥‡∏á -->
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏• | ELF</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Thai&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Noto Serif Thai', serif;
      background: #fdf9f7;
      margin: 0;
      padding: 2rem;
    }
    h1 {
      color: #800020;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0.5rem;
      text-align: left;
    }
    th {
      background: #800020;
      color: white;
    }
    tr:hover {
      background: #f8eaea;
    }
    .actions button {
      margin-right: 4px;
    }
    .status {
      font-weight: bold;
    }
    .filter {
      margin-bottom: 1rem;
    }
  </style>
</head>
<body>
  <h1>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1>

  <div class="filter">
    <label>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: <input type="text" id="searchInput" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ / ‡πÄ‡∏ö‡∏≠‡∏£‡πå / ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞" onkeyup="filterTable()" /></label>
  </div>

  <table id="ordersTable">
    <thead>
      <tr>
        <th>‡πÄ‡∏•‡∏Ç‡∏ö‡∏¥‡∏•</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠</th>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
        <th>‡∏¢‡∏≠‡∏î‡πÄ‡∏ï‡πá‡∏°</th>
        <th>‡∏°‡∏±‡∏î‡∏à‡∏≥</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        <th>‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ</th>
        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
      </tr>
    </thead>
    <tbody id="ordersBody">
      <!-- data from Supabase ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
    </tbody>
  </table>

  <script type="module">
    import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'
    const supabase = createClient(
      'https://zhiflvlhamuijgxgeadr.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpoaWZsdmxoYW11aWpneGdlYWRyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYzNzUzNzIsImV4cCI6MjA2MTk1MTM3Mn0.ls2H6MOei5bDe07jTyiquGSQj-euw8rJH4643W2zKBk'
    )

    const loadOrders = async () => {
      const { data, error } = await supabase.from('orders').select('*').order('created_at', { ascending: false })
      const tbody = document.getElementById('ordersBody')
      if (data) {
        tbody.innerHTML = data.map(row => `
          <tr>
            <td>${row.id}</td>
            <td>${row.name}</td>
            <td>${new Date(row.date).toLocaleDateString('th-TH')}</td>
            <td>‡∏ø${row.total}</td>
            <td>‡∏ø${row.deposit}</td>
            <td class="status">${row.status || '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à'}</td>
            <td><a href="${row.slip_url || '#'}" target="_blank">${row.slip_url ? '‡∏î‡∏π' : '-'}</a></td>
            <td class="actions">
              <button onclick="editOrder(${row.id})">‚úèÔ∏è</button>
              <button onclick="deleteOrder(${row.id})">üóëÔ∏è</button>
            </td>
          </tr>
        `).join('')
      }
    }
    loadOrders()

    function filterTable() {
      const input = document.getElementById("searchInput").value.toLowerCase()
      const rows = document.querySelectorAll("#ordersBody tr")
      rows.forEach(row => {
        const text = row.textContent.toLowerCase()
        row.style.display = text.includes(input) ? '' : 'none'
      })
    }
  </script>
</body>
</html>
